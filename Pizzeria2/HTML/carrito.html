<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Carrito - Masakali Pizza</title>
    <link rel="icon" href="../IMG/favicon.png" type="image/x-icon" />
    <link rel="stylesheet" href="../CSS/pagina_inicio.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
        margin: 0;
        padding: 0;
      }

      .carrito-contenido {
        width: 80%;
        max-width: 1000px;
        margin: 150px auto 20px auto;
        padding: 20px;
        background-color: #fff;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }

      h2 {
        text-align: center;
        margin-bottom: 20px;
      }

      .producto-carrito {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 20px;
        padding: 10px;
        border-bottom: 1px solid #ddd;
      }

      .producto-imagen img {
        width: 80px;
        height: 80px;
        object-fit: cover;
        border-radius: 5px;
      }

      .producto-info {
        flex: 1;
        margin-left: 15px;
      }

      .producto-info p {
        margin: 5px 0;
      }

      .producto-info p:first-child {
        font-weight: bold;
        font-size: 1.1em;
      }

      .producto-info p:last-child {
        color: #e74c3c;
        font-size: 1.2em;
        font-weight: bold;
      }

      button {
        background-color: #e74c3c;
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 5px;
        cursor: pointer;
      }

      button:hover {
        background-color: #c0392b;
      }

      .total {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 30px;
        font-size: 1.2em;
      }

      .total button {
        padding: 10px 20px;
        background-color: #27ae60;
        border-radius: 5px;
        border: none;
        cursor: pointer;
      }

      .total button:hover {
        background-color: #2ecc71;
      }

      #productos-carrito {
        display: flex;
        flex-direction: column;
      }

      #productos-carrito p {
        text-align: center;
        font-size: 1.2em;
        color: #555;
      }

      #finalizar-compra i {
        margin-right: 5px;
      }
    </style>
  </head>
  <body>
    <!-- Barra de menú superior -->
    <div class="menu">
      <div class="titulos">
        <h3>
          <i class="bi bi-list" id="menu-toggle"></i> Masakali Pizza - Cristo de
          Burgos
        </h3>
        <div class="margen">Plaza Cristo de Burgos, 1 - 41003 Sevilla</div>
      </div>
      <div class="iconos-izquierda">
        <a href="carrito.html" class="boton-menu"
          ><i class="bi bi-cart-fill" id="cart-icon"></i
        ></a>
        <a href="Inicio.html" class="boton-menu"
          ><i class="bi bi-house-fill"></i
        ></a>
      </div>
    </div>

    <div class="carrito-contenido">
      <h2>Tu Carrito</h2>
      <div id="productos-carrito" class="productos-carrito">
        <!-- Los productos se cargarán aquí mediante JavaScript -->
      </div>
      <div class="total">
        <p><strong>Total:</strong> <span id="total-precio">0€</span></p>
        <button id="finalizar-compra">Finalizar Compra</button>
      </div>
    </div>

    <div id="sidebar" class="sidebar">
      <div id="imagen-sidebar">
        <p>
          Masakali Pizza - <br />
          Cristo de Burgos
        </p>
        <img src="../IMG/fondo.png" alt="Masakali Pizza - Cristo de Burgos" />
      </div>
      <a href="Inicio_ingles.html">Idioma</a>
      <hr class="hr-sidebar" />
      <a
        href="https://www.numier.com/carta-digital/carta/masakali/sobreNosotros"
        >Sobre Nosotros</a
      >
      <hr class="hr-sidebar" />
      <a
        href="https://www.numier.com/carta-digital/carta/masakali/termsAndConditions"
        >Términos y condiciones</a
      >
      <hr class="hr-sidebar" />
      <a href="https://www.numier.com/carta-digital/carta/masakali/legalNotice"
        >Aviso legal</a
      >
      <hr class="hr-sidebar" />
      <a
        href="https://www.numier.com/carta-digital/carta/masakali/privacyPolicy"
        >Políticas de privacidad</a
      >
      <hr class="hr-sidebar" />
      <a href="https://www.numier.com/carta-digital/carta/masakali/cookiePolicy"
        >Políticas de Cookies</a
      >
      <hr class="hr-sidebar" />
      <a href="https://www.numier.com/carta-digital/carta/masakali/allergens"
        >Alérgenos</a
      >
      <hr class="hr-sidebar" />
    </div>

    <a href="#" class="flecha"><i class="bi bi-arrow-up-circle-fill"></i></a>

    <script src="../JS/Index.js" defer></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const finalizarCompraBtn = document.getElementById("finalizar-compra");

        finalizarCompraBtn.addEventListener("click", function () {
          // Deshabilita el botón para evitar múltiples clics
          finalizarCompraBtn.disabled = true;

          // Cambia el texto y un icono de check
          finalizarCompraBtn.innerHTML =
            '<i class="bi bi-check-circle-fill"></i> ¡Compra Finalizada!';

          // Agrega una animación de escala y color
          finalizarCompraBtn.style.transition =
            "transform 0.3s ease, background-color 0.3s ease";
          finalizarCompraBtn.style.transform = "scale(1.1)";
          finalizarCompraBtn.style.backgroundColor = "#2ecc71"; // Verde de éxito

          // Después de 1.5 segundos, volver al estado original
          setTimeout(() => {
            finalizarCompraBtn.style.transform = "scale(1)";
          }, 300);
        });
      });

      // Obtener el contenedor de productos y el total
const productosCarrito = document.getElementById("productos-carrito");
const totalPrecio = document.getElementById("total-precio");

// Función para renderizar el carrito
function renderizarCarrito() {
  let carrito = JSON.parse(localStorage.getItem("carrito")) || [];
  productosCarrito.innerHTML = ""; // Limpiar contenido anterior
  let total = 0;

  // Si el carrito está vacío
  if (carrito.length === 0) {
    productosCarrito.innerHTML = "<p>Tu carrito está vacío.</p>";
    totalPrecio.textContent = "0€";
    return;
  }

  // Crear elementos HTML para cada producto
  carrito.forEach((producto, index) => {
    const productoDiv = document.createElement("div");
    productoDiv.classList.add("producto-carrito");
    productoDiv.innerHTML = `
      <div class="producto-imagen">
          <img src="${producto.imagen}" alt="${producto.nombre}">
      </div>
      <div class="producto-info">
          <p>${producto.nombre}</p>
          <p>${producto.precio}€ x ${producto.cantidad} = ${(producto.precio * producto.cantidad).toFixed(2)}€</p>
          <button onclick="modificarCantidad('${producto.nombre}', -1)">-</button>
          <span>${producto.cantidad}</span>
          <button onclick="modificarCantidad('${producto.nombre}', 1)">+</button>
          <button onclick="eliminarProducto('${producto.nombre}')">Eliminar</button>
      </div>
    `;
    productosCarrito.appendChild(productoDiv);
    total += producto.precio * producto.cantidad;
  });

  // Actualizar el total
  totalPrecio.textContent = `${total.toFixed(2)}€`;
}

// Función para modificar la cantidad de un producto
function modificarCantidad(nombre, cambio) {
    let carrito = JSON.parse(localStorage.getItem("carrito")) || [];
    
    // Buscar el producto en el carrito
    let index = carrito.findIndex(producto => producto.nombre === nombre);
    if (index !== -1) {
        carrito[index].cantidad += cambio;

        // Si la cantidad es menor o igual a 0, eliminar el producto
        if (carrito[index].cantidad <= 0) {
            carrito.splice(index, 1);
        }
    }

    localStorage.setItem("carrito", JSON.stringify(carrito));
    renderizarCarrito();
}

// Función para eliminar completamente un producto
function eliminarProducto(nombre) {
    let carrito = JSON.parse(localStorage.getItem("carrito")) || [];
    carrito = carrito.filter(producto => producto.nombre !== nombre); // Filtrar el producto
    localStorage.setItem("carrito", JSON.stringify(carrito));
    renderizarCarrito();
}

// Llamada a la función para renderizar los productos al cargar la página
renderizarCarrito();

    </script>
  </body>
</html>